<div>
<p align="center" style="font-size=14pt;¬†font-weight: bolder;">–ú–ò–ù–ò–°–¢–ï–†–°–¢–í–û –ù–ê–£–ö–ò –ò –í–´–°–®–ï–ì–û –û–ë–†–ê–ó–û–í–ê–ù–ò–Ø –†–û–°–°–ò–ô–°–ö–û–ô –§–ï–î–ï–†–ê–¶–ò–ò
<br>
–§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–µ –±—é–¥–∂–µ—Ç–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
<br>
¬´–ß—É–≤–∞—à—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ò.–ù. –£–ª—å—è–Ω–æ–≤–∞¬ª
<br>
–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ 
<br>
–ö–∞—Ñ–µ–¥—Ä–∞ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏
<br> <br> <br> <br> <br> <br> <br><br> <br> <br>
–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
<br>
–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 5
<br>
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π —Å 31 - 32
</p>

<br> <br> <br> <br><br> <br><br>

<span>
<p align="right" style="font-size=14pt; font-weight: bolder;">–í—ã–ø–æ–ª–Ω–∏–ª:</p>
<p align="right" style="font-size=14pt;">–°—Ç—É–¥–µ–Ω—Ç –≥—Ä—É–ø–ø—ã –ò–í–¢-41-20 <br>
–ì–∞–ª–∫–∏–Ω –î.–°.
</p>
</span> <br>

<span>
<p align="right" style="font-size=14pt; font-weight: bolder;">–ü—Ä–æ–≤–µ—Ä–∏–ª:</p>
<p align="right" style="font-size=14pt;">–ö–æ–≤–∞–ª–µ–≤ –°.B.</p>
</span>

<br> <br>
<br> <br>
<br> <br>
<br> <br>
<p align="center" style="font-size=10pt;">–ß–µ–±–æ–∫—Å–∞—Ä—ã, 2024</p>
<div style="page-break-after:always;¬† visibility:hidden"></div>
</div>

### –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã (–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤ MPI + OpenMP):

#### –ó–∞–¥–∞–Ω–∏–µ 31. –ü—Ä–æ–≥—Ä–∞–º–º–∞ "I am":

> [!info] –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
> –ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è n –Ω–∏—Ç–µ–π. –ö–∞–∂–¥–∞—è –Ω–∏—Ç—å –¥–æ–ª–∂–Ω–∞ –≤—ã–≤–æ–¥–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω —Å–≤–æ–π –Ω–æ–º–µ—Ä, –Ω–æ–º–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–æ–¥–∏—Ç–µ–ª—è –∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏—Ç–µ–π –≤–æ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
> 
> I am <–ù–æ–º–µ—Ä –Ω–∏—Ç–∏> thread from <–ù–æ–º–µ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞> process. Number of hybrid threads = <–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏—Ç–µ–π * –ö–æ–ª–∏—á–µ- —Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤>

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ n ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ ¬´I am <–ù–æ–º–µ—Ä –Ω–∏—Ç–∏> thread from <–ù–æ–º–µ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞> process. Number of hybrid threads = <–ö–æ- –ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏—Ç–µ–π * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤>¬ª

| –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| ---- | ---- |
| 3 | I am 0 thread from 0 process. Number of hybrid threads = 6<br><br>I am 1 thread from 0 process. Number of hybrid threads = 6<br><br>I am 2 thread from 0 process. Number of hybrid threads = 6<br><br>I am 0 thread from 1 process. Number of hybrid threads = 6<br><br>I am 1 thread from 1 process. Number of hybrid threads = 6<br><br>I am 2 thread from 1 process. Number of hybrid threads = 6 |

**–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã:**

1. –ö–ª–∞—Å—Å Main

```cs
var lab11 = new Lab11("Lab11", args);  
lab11.Start();
```

<div style="page-break-after:always;¬† visibility:hidden"></div>

2. –ö–ª–∞—Å—Å Lab11

```cs
using MPI;
using ProgramMPI.Interfaces;

namespace ProgramMPI.Labs
{
¬† ¬† public class Lab13 : ILab
¬† ¬† {
¬† ¬† ¬† ¬† public string Name { get; set; }
¬† ¬† ¬† ¬† public string[] _args { get; set; }

¬† ¬† ¬† ¬† public Lab13(string name, string[] args)
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† Name = name;
¬† ¬† ¬† ¬† ¬† ¬† _args = args;
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† public void ProccessStart(string[] args)
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† using (new MPI.Environment(ref args))
¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† Intracommunicator comm = Communicator.world;

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† //Console.WriteLine("–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏—Ç–µ–π n:");
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† //int n = int.Parse(Console.ReadLine() ?? "1");

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† int n = 3;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† int numProcesses = comm.Size;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† int processRank = comm.Rank;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† int totalThreads = n * numProcesses;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† var options = new ParallelOptions { MaxDegreeOfParallelism = 1 }; 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Å—Ç–µ–ø–µ–Ω—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –¥–æ 1
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† Parallel.For(0, n, options, i =>
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† Print(i, processRank, totalThreads);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† });
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† public void Start()
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† Console.WriteLine(this);
¬† ¬† ¬† ¬† ¬† ¬† 
¬† ¬† ¬† ¬† ¬† ¬† ProccessStart(_args);
¬† ¬† ¬† ¬† ¬† ¬† 
¬† ¬† ¬† ¬† ¬† ¬† Console.WriteLine("\n");
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† public override string ToString() => $"{Name} started classes:";

¬† ¬† ¬† ¬† private void Print(int index, int processRank, int totalThreads) => Console.WriteLine($"I am {index} thread from {processRank} process. Number of hybrid threads = {totalThreads}.");

¬† ¬† }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

![[CleanShot 2024-02-13 at 11.29.06@2x.png]]

<div style="page-break-after:always;¬† visibility:hidden"></div>

#### –ó–∞–¥–∞–Ω–∏–µ 14.  –ü—Ä–æ–≥—Ä–∞–º–º–∞ "–ß–∏—Å–ª–æ pi":

> [!info] –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
> –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ ùúã (—Å–º. –∑–∞–¥–∞–Ω–∏–µ 8) —Å –∏—Å–ø–æ–ª—å–∑–æ- –≤–∞–Ω–∏–µ–º MPI+OpenMP

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** –æ–¥–Ω–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ N (—Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è)
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** –æ–¥–Ω–æ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ pi

| –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| ---- | ---- |
| 1000000000 | 3.14159265 |

**–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã:**

1. –ö–ª–∞—Å—Å Main

```cs
var lab12 = new Lab12("Lab12");  
lab14.Start();
```

<div style="page-break-after:always;¬† visibility:hidden"></div>

2. –ö–ª–∞—Å—Å Lab12

```cs
using MPI;
using ProgramMPI.Interfaces;

namespace ProgramMPI.Labs
{
¬† ¬† public class Lab14 : ILab
¬† ¬† {
¬† ¬† ¬† ¬† public string Name { get; set; }
¬† ¬† ¬† ¬† public string[] _args { get; set; }

¬† ¬† ¬† ¬† public Lab14(string name, string[] args)
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† Name = name;
¬† ¬† ¬† ¬† ¬† ¬† _args = args;
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† public void ProccessStart(string[] args)
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† using (new MPI.Environment(ref args))
¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† Intracommunicator comm = Communicator.world;

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† int N;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (comm.Rank == 0)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† //Console.WriteLine("–í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ N: ");
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† //N = int.Parse(Console.ReadLine() ?? "1000000000"); // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –≤–≤–æ–¥ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† N = 1000000000;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† else
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† N = 0;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† // –†–∞—Å—Å—ã–ª–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è N –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† comm.Broadcast(ref N, 0);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† double pi = CalculatePi(N, comm.Rank, comm.Size);

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† // –°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è ùúã —Å–æ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† double[] allPi = comm.Gather(pi, 0);

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (comm.Rank == 0)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† double finalPi = 0;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† foreach (var p in allPi)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† finalPi += p;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† Print(finalPi);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† public void Start()
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† Console.WriteLine(this);

¬† ¬† ¬† ¬† ¬† ¬† ProccessStart(_args);

¬† ¬† ¬† ¬† ¬† ¬† Console.WriteLine("\n");
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† private double CalculatePi(int n, int rank, int size)
¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† double sum = 0.0;
¬† ¬† ¬† ¬† ¬† ¬† double step = 1.0 / n;
¬† ¬† ¬† ¬† ¬† ¬† int localN = n / size;
¬† ¬† ¬† ¬† ¬† ¬† int start = rank * localN;
¬† ¬† ¬† ¬† ¬† ¬† int end = start + localN;

¬† ¬† ¬† ¬† ¬† ¬† object locker = new object();

¬† ¬† ¬† ¬† ¬† ¬† // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Parallel.For –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ OpenMP
¬† ¬† ¬† ¬† ¬† ¬† Parallel.For(start, end, i =>
¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† double x = (i + 0.5) * step;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† double term = 4.0 / (1.0 + x * x);

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† lock (locker)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† sum += term;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† });

¬† ¬† ¬† ¬† ¬† ¬† return sum * step;
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† public override string ToString() => $"{Name} started classes:";

¬† ¬† ¬† ¬† private void Print(double pi) => Console.WriteLine($"Result PI = {pi}");

¬† ¬† }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

![[CleanShot 2024-02-13 at 11.34.59@2x.png]]

<div style="page-break-after:always;¬† visibility:hidden"></div>